# Overview

# Description

# **Grammar Error Correction Prompathon**

이 프로젝트는 Solar Pro API를 활용하여 오로지 프롬프트만으로 한국어 문장의 맞춤법을 교정하여 성능을 올리는 프롬프톤입니다. 모델 튜닝이 아닌 프롬프트 엔지니어링만으로 교정 태스크를 해결하는 것이 목표입니다.

한국어는 띄어쓰기, 조사 사용, 문장 부호 등 다양한 문법 규칙을 가지고 있어 맞춤법 교정이 쉽지 않습니다. 특히 기사나 공식 문서 작성 시 정확한 맞춤법과 문법은 필수적입니다. 하지만 많은 사람들이 맞춤법과 문법에 어려움을 겪고 있으며, 전문가의 검토를 받기에는 시간과 비용이 많이 소요됩니다.

- 문서 작성 시간 단축
- 맞춤법 검토 비용 절감
- 일관된 문서 품질 유지

등의 효과를 기대할 수 있습니다.

본 대회에서는 AI Hub 맞춤법 교정 데이터셋을 사용하여, 오류가 있는 문장을 입력받아 모델 튜닝이 아닌 "**오로지 프롬프트**"만으로 올바른 맞춤법과 문법으로 교정된 문장을 출력하는 최적의 프롬프트를 개발합니다.

데이터셋은 다양한 문법적 오류 유형을 포함하고 있으며, 띄어쓰기, 맞춤법, 문장 부호, 문법적 오류, 문장 구조 오류 등이 포함되어 있습니다.

- **입력 데이터**
    - 입력 데이터는 CSV 형식으로 제공되며, 각 행은 하나의 문장과 관련 메타데이터를 포함합니다. 파일은 다음과 같은 열을 포함합니다:
        - id: 문장의 고유 식별자 (grm으로 시작하는 형식)
        - source: 문장의 출처 (예: 질문게시판, 자유게시판)
        - date: 문장 작성 날짜 (YYYYMMDD 형식)
        - gender: 작성자 성별 (F, M)
        - age: 작성자 나이
        - err_sentence: 오류가 있는 원본 문장
        - cor_sentence: 정답 문장 (train.csv에만 포함)
- **출력 데이터**
    - 출력 데이터는 CSV 형식으로 제출해야 하며, 각 행은 하나의 교정된 문장을 나타냅니다. 파일은 다음과 같은 열을 포함합니다:
        - id: 문장의 고유 식별자
        - err_sentence: 원본 오류 문장
        - cor_sentence: 교정된 문장

## **평가 방법**

- Recall: 정답 문장과 예측 문장 간의 일치도
- Precision: 예측 문장의 정확도
- 최종 순위는 Recall 점수로 결정됩니다.

더 자세한 설명은 Metrics 페이지 참고 바랍니다.

## **전체 프롬프톤 프로세스**

1. 다양한 프롬프트 템플릿 실험
2. 최적의 프롬프트 템플릿 선택
3. 테스트 데이터에 대한 예측 수행
4. 결과를 submission.csv 형식으로 리더보드에 제출

본 프롬프톤을 통해 참가자들은 프롬프트 엔지니어링 실전 경험을 쌓고, LLM 모델 활용 방법을 학습할 수 있습니다. 또한, 실제 비즈니스 문제를 해결하는 경험을 얻을 수 있습니다.

이제 최적의 프롬트를 찾으러 가볼까요~?

---

# Metric

- LCS : 최장 공통 부분 수열
- Recall : 재현율

---

# Rule

## **프롬프트 작성 규칙**

- **프롬프트 전용 출력**: 결과물은 프롬프트 작성만으로 생성해야하며 수동으로 편집을 금지합니다.
- **프롬프트 길이 제한**: **최대 2000 토큰**
    - 해당 기준은 실제 엔터프라이즈에서 활용하는 기준입니다.

---

# Prize

참가자의 제출물은 다음 세 가지 항목에 따라 총 100점 만점으로 평가됩니다:

### **1. 정량 평가 (70점)**

- **리더보드 기반의 자동 채점 방식**으로 이루어집니다.

---

### **2. 프롬프트 템플릿 평가 (20점)**

제출된 프롬프트의 품질은 아래의 5가지 세부 항목을 기준으로 전문가가 평가합니다.

| 평가 항목 | 설명 |
| --- | --- |
| 실행 가능성 및 실용성 | 프롬프트 기반 솔루션이 현실적인 환경에서 실제로 실행 가능한지 여부와, 실생활 혹은 업무에서의 활용 가치를 평가합니다. |
| 최적화 및 효율성 | 최소한의 자원(프롬프트 수, 토큰 수 등)으로 최대의 성능을 이끌어낸 정도를 평가합니다. |
| 창의성 및 독창성 | 기존 방식과 다른 참신한 아이디어, 색다른 접근 방식, 또는 혁신적인 해결 전략이 포함되어 있는지를 평가합니다. |
| 명료성 및 논리성 | 프롬프트의 문장이 얼마나 명확하고 이해하기 쉬운지, 그리고 논리적인 구성과 단계적 흐름이 잘 갖추어졌는지를 평가합니다. |
| 기술 적합성 및 난이도 | 문제 해결을 위한 기술(프롬프트 기법, 체인 구성 등)이 적절히 선택되었는지, 그리고 고급 기법이나 높은 난이도에 도전했는지를 평가합니다. |

---

### **3. 발표 및 발표자료 평가 (10점)**

최종 발표에서 사용된 **PPT 자료의 완성도**와 **발표 전달력**을 종합적으로 평가합니다.

# Data

## **1. 학습 데이터 개요**

### **데이터셋 디렉토리**

```
data/
├── train.csv          # 학습 데이터
├── test.csv           # 테스트 데이터
└── sample_submission.csv  # 제출 샘플
```

### **데이터셋 세부 정보**

| id | source | date | gender | age | err_sentence | cor_sentence |
| --- | --- | --- | --- | --- | --- | --- |
| grm2208090042706 | 질문게시판 | 20210627.0 | F | 17.0 | 서사의 흐름이 역순행적으로 진행된다고 보는게 맞나요? | 서사의 흐름이 역 순행적으로 진행된다고 보는 것이 맞나요? |
| grm2207290015743 | 자유게시판 | 20210709.0 | M | 21.0 | 근대 이런 시험을 마주할 때 중요한 건 시험 때도 중요하지만 ... | 근대 이런 시험을 마주할 때 중요한 건 시험 때도 중요하지만 ... |
| grm2209090068921 | 질문게시판 | 20211229.0 | M | 17.0 | 속도와 속력에서공통점이있다고... | 속도와 속력에서 공통점이 있다고... |
| grm2207290019987 | 자유게시판 | 20210224.0 | M | 17.0 | 제가 자퇴 전 전교권에 들어본적이 있는데요 | 제가 자퇴 전에 전교권에 들어본 적이 있는데요 |
| grm2209270109173 | SNS | 20220419.0 | F | 19.0 | 쪼끔 더 자세한 설명이 필요해요 | 쪼끔 더 자세한 설명이 필요해요 |
- **데이터 출처**: AI Hub 한국어 맞춤법 교정 데이터셋
- 데이터 개수 : 43,480 문장
- **데이터 형식**: CSV
- **데이터 구성**:
    - id: 문장의 고유 식별자 (grm 또는 ext로 시작)
    - source: 데이터 출처 (질문게시판, 자유게시판, SNS, 뉴스기사)
    - date: 데이터 수집 날짜 (YYYYMMDD 형식)
    - gender: 작성자 성별 (M/F)
    - age: 작성자 연령
    - err_sentence: 오류가 있는 원본 문장
    - cor_sentence: 교정된 정답 문장 (*학습데이터에만 존재)

## **2. 평가 데이터 개요**

### **데이터셋 세부 정보**

| id | source | date | gender | age | err_sentence |
| --- | --- | --- | --- | --- | --- |
| grm2207150031941 | 자유게시판 | 20210622.0 | F | 23.0 | 중국인 유학생들이학교한테 중국어 강의 열어달라고 건의를 엄청나게해서 ... |
| grm2207280039103 | 자유게시판 | 20220228.0 | M | 20.0 | 서강대정말 집 코앞에있는데... |
| grm2206230039136 | 자유게시판 | 20210307.0 | F | 15.0 | 국어비문학 트린거 오답할때요! |
| grm2208310053956 | 질문게시판 | 20220203.0 | F | 17.0 | 구성어떻게되는지자세히 알려주실수있나요? |
| grm2210060106307 | SNS | 20201125.0 | F | 20.0 | 전문대라도 졸업장이라도있는게 어디냐고그러더라. |
- 파일 : test.csv
- **데이터 수**: 10,870개 문장
    - Public, Private의 경우 전체 평가데이터를 랜덤하게 1:1로 나누어 구성했습니다.
    - public 값에 해당하는 데이터는 대회 진행 기간 중(public 리더보드)에 채점이 이루어지며, private 값에 해당하는 데이터는 대회 종료 후(private 리더보드) 최종 순위 산출에 활용됩니다.
- **구조**:
    - id: 문장의 고유 식별자
    - source: 데이터 출처
    - date: 데이터 수집 날짜
    - gender: 작성자 성별
    - age: 작성자 연령
    - err_sentence: 오류가 있는 원본 문장
    - *학습 데이터와 달리, cor_sentence(정답)이 없습니다.*

### **제출 샘플 데이터셋**

| id | err_sentence | cor_sentence |
| --- | --- | --- |
| grm2207150031941 | 중국인 유학생들이학교한테 중국어 강의 열어달라고 건의를 엄청나게해서 ... | NaN |
| grm2207280039103 | 서강대정말 집 코앞에있는데... | NaN |
| grm2206230039136 | 국어비문학 트린거 오답할때요! | NaN |
| grm2208310053956 | 구성어떻게되는지자세히 알려주실수있나요? | NaN |
| grm2210060106307 | 전문대라도 졸업장이라도있는게 어디냐고그러더라. | NaN |
- 파일 : sample_submission.csv
- 데이터 구조
    - id: 문장의 고유 식별자
    - err_sentence: 오류가 있는 원본 문장
    - cor_sentence: Prompt를 바탕으로 **교정된 예측 문장**

# Baseline code

## 1. 코드 파일 구조

```
**code/
├── main.py              # 메인 실행 파일
├── config.py            # 설정 파일
├── requirements.txt     # 필요한 패키지 목록
├── __init__.py         # 패키지 초기화 파일
├── utils/              # 유틸리티 함수들
│   ├── __init__.py     # utils 패키지 초기화
│   ├── experiment.py   # 실험 실행 및 API 호출
│   └── metrics.py      # 평가 지표 계산
└── prompts/            # 프롬프트 템플릿 저장
    ├── __init__.py     # prompts 패키지 초기화
    └── templates.py    # 프롬프트 템플릿 정의**
```

## **2. 구성 파일 용도**

- [**main.py**](http://main.py/)
    - 대회의 메인 실행 파일
    - 데이터 로딩 및 전처리
    - 여러 템플릿 실험 실행
    - 최적의 템플릿 선택 및 테스트 데이터 예측
    - 결과 저장 및 성능 출력
- [**config.py**](http://config.py/)
    - 모델 설정, 데이터 경로, 프롬프트 설정 등 전반적인 설정값 관리
    - 템플릿 설정 (템플릿 이름, 온도, 배치 크기)
    - 데이터 설정 (데이터 경로, 토이 데이터 크기, 랜덤 시드)
    - API Key 설정 및 호출
        - .env 파일 생성
        - 환경변수 파일 내 API Key 저장

```
UPSTAGE_API_KEY = up_**** 
```

### **utils/**

- **/[experiment.py](http://experiment.py/)**
    - ExperimentRunner 클래스 구현
    - API 호출 및 응답 처리
    - 단일 문장 처리 및 배치 처리
    - 템플릿별 실험 실행
- [**metrics.py**](http://metrics.py/)
    - 텍스트 토큰화 및 LCS(최장 공통 부분수열) 계산
    - 교정 결과 평가 (Recall, Precision)
    - 차이점 분석 및 점수 계산

### **prompts/**

- [**templates.py**](http://templates.py/)
    - 프롬프트 템플릿 정의
    - 다양한 프롬프트 템플릿 실험이 가능합니다.
    - 더 자세한 solar prompt 방법론은 Upstage Solar Cookbook([**https://github.com/upstageAI/solar-prompt-cookbook**](https://github.com/upstageAI/solar-prompt-cookbook))을 참고하세요!

## **3. 베이스라인 코드 설명**

- 사용 모델 : Solar Pro 모델 사용
- 데이터셋
    - AI Hub 맞춤법 교정 데이터셋 사용
- 기본 성능
    - Public 테스트셋 기준 정확도: 64.42 점

Basic 템플렛

```
f"아래 문장의 띄어쓰기, 맞춤법, 문장 부호를 모두 올바르게 고쳐주세요. 반드시 교정된 문장만을 출력하세요. \n문장: {sentence}\n교정:
```

### **ubmission 파일 설명**

- 형식
    - id: 문장의 고유 식별자
    - err_sentence: 오류가 있는 원본 문장
    - cor_sentence : 프롬프트를 통해 교정된 예측 문장

## **4. 베이스라인 코드 실행 방법**

```
# 1. 필요한 패키지 설치
pip install -r requirements.txt

# 2. 메인 스크립트 실행
python main.py
```

# 질문

1. 일일 트래픽 제한 있나요?
2. 벡터 DB에 외부 문서를 RAG 넣어서 사용해도 되나요?
3. single turn이 아니라 multi turn을 사용해도 되는걸까요? Multi turn의 경우, 2000 토큰 제한은 모든 턴을 합쳐서 적용되나요, 아니면 각각 턴마다 적용되나요?
    
    > 'Q. 코드를 확인해보니 무조건 single turn이고 역할도 user로만 고정되어 있어서 이런 거 수정해도 될까요?
    A. 네, 베이스라인 코드는 말 그래도 원활한 경진대회를 위해 짜둔 가이드여서 변경해주셔도 무방합니다.'
    > 
4. train 데이터 셋의 cor_sentence를 살펴보다 아래와 같이 맞춤법 수정이 안 된 케이스를 발견했습니다.
    
    > 난 그래도 이번에 부산내려갔을때 머리 좀 자르구 파마하니가 쪼끔 뭐랄까 쪼끔 관리가 된 기분!
    → 난 그래도 이번에 부산 내려갔을 때 머리 좀 자르고 파마하니까 쪼끔 뭐랄까 쪼끔 관리가 된 기분!
    > 
    
    약 88개의 **쪼금**과 52개의 **쪼끔**에 대해 각 18개, 6개가 수정되지 않았습니다.맞춤법 오류가 발견된 데이터 셋에 대한 수정이 이루어질지 궁금합니다
    
5. 하나의 케이스를 교정할 때 여러번의 API 호출이 가능한가요?
6. API에서 제공하는 Function calling 기능을 사용해도 괜찮은가요?
7. LangChain이나 LangGraph 같은 라이브러리를 따로 사용해도 될까요?
8. OutputParser를 이용해서 특정 형태로 결과 뽑아내고 그 결과 안에서 내용을 뽑는 식으로 최종 결과를 구성해도 되나요?
9. 구체적인 API 호출 개수의 기준을 알 수 있을까요? 예를 들어서, RAG에서 로컬 임베딩 모델을 사용한다고 하면 따로 API 호출 없이 가능할 것 같은데, 이러한 chain도 API 호출 개수에 포함되는 건지 아니면 진짜로 API 형태로 된 호출만 의미하는 것인지 궁금합니다.
10. [templates.py](http://templates.py/) 파일 외에 main.py나 experiment.py의 코드를 수정해서 성능을 올리는게 가능한가요? 예를 들어 temperature나 batch 등을 수정하는 것에 대한 문의입니다.

---

# 답변 결과

1. 트래픽 제한은 [Rate Limits](https://console.upstage.ai/docs/guides/rate-limits) 문서 참고해주시면 됩니다.
2. RAG 는 활용 가능하나, 외부 문서/데이터 활용은 금지되어 있습니다. 제공드린 데이터나 메타데이터를 넣는 것은 가능합니다.
3. 3번 내용은 대회 룰에도 추가해두었습니다!**3. 네,  Single-turn과 Multi-turn 모두 허용됩니다.**
- 1. 프롬프트 구조(System / User / Assistant)를 활용하여 multi-turn으로 구성하셔도 됩니다.
- 2. **전체 session 기준 2000 토큰 이내로 작성** 해주시면 됩니다!
1. **'쪼금'은 비표준어가 아닙니다.**   [국립국어원 표준국어대사전](https://stdict.korean.go.kr/search/searchView.do)에 따르면 아래와 같이 나와있습니다(저도 처음 알았네요 ㅎㅎ) 따라서 train 데이터셋에서 '쪼금'이 그대로 사용된 것은 맞춤법 오류가 아니라 표준어 사용이기에 그대로 이용해주시면 됩니다!
2. 네 가능합니다.
    1. 하나의 케이스 교정 시 **`최대 3회 이내`**  로 횟수를 제한합니다.
    2. 예를 들어, 검색 → 요약 → 교정 등 **한 케이스를 처리하기 위해 최대 3회 이내로 API를 호출**하실 수 있습니다.
3. 네, Function Calling 기능도 활용하셔도 됩니다.
4. 네 가능합니다. 프롬프트 기반 성능 향상을 목표로 하는 대회이므로, LangChain, LangGraph 등의 워크플로우 라이브러리를 활용하여 프롬프트 chaining이나 flow를 구성하셔도 무방합니다. 다만, 워크플로우 자체보다는 프롬프팅 자체에 집중해주시고, 토큰 제한이나 API 호출수 제한만 잘 지켜주시면 됩니다.
5.  네 output parser도 활용 가능합니다.
6. API 호출 개수 기준은 **'Solar Chat API 호출 기준'**으로 이해해주시면 됩니다!
7. 네, 가능합니다! 프롬프트 엔지니어링과 관련된 모든 실험 파라미터 조정은 자유롭게 허용됩니다.따라서 `main.py`나 [`experiment.py](http://experiment.py)` 에서 temperature, top_p, batch size 등 다양한 파라미터 세팅을 조정하여 성능을 높이는 것도 가능합니다. **프롬프트 기반** 다양한 실험과 최적화 전략은 모두 열려 있습니다.